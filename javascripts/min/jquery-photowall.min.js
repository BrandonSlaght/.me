function getScrollBarWidth(){var o=document.createElement("p");o.style.width="100%",o.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(o),document.body.appendChild(t);var e=o.offsetWidth;t.style.overflow="scroll";var i=o.offsetWidth;return e==i&&(i=t.clientWidth),document.body.removeChild(t),e-i}function $_GET(){var o=location.hash;if(a=o.match(/[^&#=]*=[^&#=]*/g),r={},a)for(i=0;i<a.length;i++)r[a[i].match(/[^&#=]*/)[0]]=a[i].match(/=([^&#]*)/)[0].replace("=","");return r}jQuery.browser||(jQuery.uaMatch=function(o){o=o.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(o)||/(webkit)[ \/]([\w.]+)/.exec(o)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(o)||/(msie) ([\w.]+)/.exec(o)||o.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(o)||[];return{browser:t[1]||"",version:t[2]||"0"}},matched=jQuery.uaMatch(navigator.userAgent),browser={},matched.browser&&(browser[matched.browser]=!0,browser.version=matched.version),browser.chrome?browser.webkit=!0:browser.webkit&&(browser.safari=!0),jQuery.browser=browser);var PhotoWall={version:"0.1.4",_photos:{},_el:null,_c_width:0,_c_height:0,_first_big:null,_zoom_trigger:null,_zs:null,_zoom_timeout:null,_last_line:[],_must_resize:!1,_inited:!1,_block_resize:!1,_line_max_height:0,options:{lineMaxHeight:150,lineMaxHeightDynamic:!1,baseScreenHeight:600,isFirstBig:!1,firstBigWidthPercent:.41,padding:10,zoomAction:"mouseenter",zoomTimeout:500,zoomDuration:300,zoomImageBorder:5,showBoxPadding:2,showBoxSocial:!0},init:function(o){PhotoWall.options=$.extend(PhotoWall.options,o),PhotoWall.options.baseScreenHeight=$(window).height(),PhotoWall._el=o.el+" .body",PhotoWall._c_width=$(PhotoWall._el).width()-getScrollBarWidth(),PhotoWall._c_height=$(PhotoWall._el).height(),PhotoWall._line_max_height=PhotoWall.options.lineMaxHeight,PhotoWall._setLineMaxHeightDynamic(),$(PhotoWall._el).html("").addClass("clearfix"),$(window).resize(PhotoWall.RESIZE)},_init_socials:function(){var o,t="script",e=document,i=e.getElementsByTagName(t)[0],h=function(h,n){e.getElementById(n)||((o=e.createElement(t)).src=h,o.id=n,i.parentNode.insertBefore(o,i))};h("https://connect.facebook.net/en_US/all.js#xfbml=1","fbjssdk"),h("https://apis.google.com/js/plusone.js","gplus1js"),h("https://platform.twitter.com/widgets.js","tweetjs")},_setLineMaxHeightDynamic:function(){if(PhotoWall.options.lineMaxHeightDynamic){var o=$(window).height()/PhotoWall.options.baseScreenHeight;PhotoWall.options.lineMaxHeight=PhotoWall._line_max_height*o>=100?PhotoWall._line_max_height*o:100}},RESIZE:function(){var o=$(PhotoWall._el).width(),t=$(PhotoWall._el).height();PhotoWall._setLineMaxHeightDynamic(),!PhotoWall.options.lineMaxHeightDynamic&&PhotoWall._c_width==o||PhotoWall._block_resize||(ShowBox.opened()?PhotoWall._must_resize=!0:(PhotoWall._c_width=o,PhotoWall._c_height=t,PhotoWall._must_resize=!1,$(PhotoWall._el).html(""),PhotoWall.show()))},load:function(o){if(!PhotoWall.options.lineMaxHeightDynamic)for(var t in o){var e=PhotoWall.options.lineMaxHeight/o[t].th.height;o[t].th.width=Math.floor(o[t].th.width*e),o[t].th.height=PhotoWall.options.lineMaxHeight}PhotoWall._photos=o,PhotoWall.show()},show:function(o){var t=new Array,e=[],i=0;if(o)t=o,e=PhotoWall._last_line[0],i=PhotoWall._last_line[1];else{if(!PhotoWall._photos)return;$(PhotoWall._el).html(""),t=PhotoWall._photos}var h=function(o,t,e,i,h,n,a,l){var s="",r="";a&&l&&(s="position:absolute;left:-"+Math.round((e-a)/2)+"px;top:-"+Math.round((i-l)/2)+"px;",r="pw-crop");var d=$('<div id="'+o+'" class="pw-photo '+r+' clearfix" style="margin:'+t+"px;width:"+e+"px;height:"+i+'px;float:left;"><a class="pw-link" href="'+h+'"><img class="pw-zoom" src="'+n+'" width="'+e+'" height="'+i+'" style="'+s+'" /></a></div>');return $.browser.msie?d.find("img").hide().load(function(){$(this).fadeIn(300)}):d.find("img").css("opacity",0).load(function(){$(this).delay(700*Math.random()+300).animate({opacity:1},{duration:1e3})}),d},n=function(o,t,e,i){var n=o.length,a=$("<div class='pw-line'></div>").appendTo(PhotoWall._el),l=i?PhotoWall._c_width*PhotoWall.options.firstBigWidthPercent+2*PhotoWall.options.padding:0,s=(PhotoWall._c_width-l-n*PhotoWall.options.padding*2)/t;if(e)s=1;var r=0;for(var d in o){var w,p=Math.floor(o[d].th.width*s),c=Math.floor(o[d].th.height*s);r+=p,e||d!=n-1||(p+=PhotoWall._c_width-l-n*PhotoWall.options.padding*2-r),w=h(o[d].id,PhotoWall.options.padding,p,c,o[d].img,o[d].th.src),a.append(w)}return w},a=0,l=(PhotoWall.options.padding,!0);for(var s in t){var r=0,d=!1;if(PhotoWall.options.lineMaxHeightDynamic){var w=PhotoWall.options.lineMaxHeight/t[s].th.height;t[s].th.width=Math.floor(t[s].th.width*w),t[s].th.height=PhotoWall.options.lineMaxHeight}if(PhotoWall.options.isFirstBig&&l)PhotoWall._first_big=t[s],l=!1;else{if(a<2&&PhotoWall.options.isFirstBig){var p=PhotoWall._first_big.th.height;d=!0,r=PhotoWall._c_width*PhotoWall.options.firstBigWidthPercent}if(e.push(t[s]),(i+=t[s].th.width)>=PhotoWall._c_width-r){var c=n(e,i,0,d);a<2&&c.height(),PhotoWall._last_line=[e,i,c],e=[],i=0,a++}}}if(PhotoWall.options.isFirstBig){var x=PhotoWall._first_big,_=(w=PhotoWall._c_width*PhotoWall.options.firstBigWidthPercent/t[s].width,x.width*w);p=x.height*w;x.th.width=_,x.th.height=p,x.th.src=x.img,x.th.zoom_src=x.img,PhotoWall._first_big=h(x.id,PhotoWall.options.padding,_,p,x.img,x.img).prependTo(PhotoWall._el)}if(e){a<2&&PhotoWall.options.isFirstBig&&(d=!0);c=n(e,i,1,d);PhotoWall._last_line=[e,i,c]}PhotoWall._c_width<$(PhotoWall._el).width()&&PhotoWall.RESIZE(),PhotoWall._inited||(PhotoWall._inited=!0,PhotoWall.initGUI())},initGUI:function(){PhotoWall.options.zoom&&PhotoWall.initZoom(),PhotoWall.options.showBox&&PhotoWall.initShowBox()},initShowBox:function(){var o="",t=null;PhotoWall.options.showBoxSocial&&(o='<div style="padding-top: 5px;width: 250px;position: relative;left: 50%;margin-left: -125px;"><div style="float:left;margin-top: 5px;width:80px;"><div id="gplus" class="g-plusone" data-size="medium"></div></div><div style="float:left;margin-top:5px;width:90px;"><a href="https://twitter.com/share" class="twitter-share-button">Tweet</a></div><div style="float:left;margin-top:5px;width:80px;" id="fblike"><fb:like send="false" layout="button_count" width="100" show_faces="false"></fb:like></div></div>',t=function(){"undefined"!=typeof FB&&FB.XFBML.parse(document.getElementById("fblike")),"undefined"!=typeof gapi&&gapi.plusone.render(document.getElementById("gplus"),{href:location.href,annotation:"bubble",width:90,align:"left",size:"medium"}),"undefined"!=typeof twttr&&($("#showbox .twitter-share-button").attr("data-url",location.href),twttr.widgets.load())}),ShowBox.init(PhotoWall._el+" a.pw-link",{closeCallback:function(){PhotoWall._must_resize&&PhotoWall.RESIZE()},menuBarContent:o,onUpdate:t}),PhotoWall.options.showBoxSocial&&PhotoWall._init_socials()},initZoom:function(){$(".pw-zoom").on(PhotoWall.options.zoomAction,function(){var o=$(this);parseInt(o.css("opacity"))&&(o.stop().addClass("pw-photo-hover"),PhotoWall._zoom_timeout=setTimeout(function(){if(o.removeClass("pw-photo-hover"),o.addClass("pw-photo-zoomed"),PhotoWall._zoom_timeout){PhotoWall._zs=[o.width(),o.height()];var t=o.parent().parent(),e=PhotoWall._photos[t.attr("id")],i=$("<img/>");i.attr("src",e.th.zoom_src),i.load(function(){o.attr("src",$(this).attr("src")),$(this).remove()});var h=Math.round(o.width()*e.th.zoom_factor),n=Math.round(o.height()*e.th.zoom_factor),a=h-o.width(),l=n-o.height(),s=.5*-a-PhotoWall.options.zoomImageBorder,r=.5*-l-PhotoWall.options.zoomImageBorder,d=t.offset(),w=$(window),p=1;d.left+s+h>w.width()+w.scrollLeft()&&(s-=d.left+s+h-(w.width()+w.scrollLeft())+2*PhotoWall.options.zoomImageBorder),d.left+s<w.scrollLeft()&&(s-=d.left+s-w.scrollLeft()),d.top+r+n>w.height()+w.scrollTop()&&(r-=d.top+r+n-(w.height()+w.scrollTop())+2*PhotoWall.options.zoomImageBorder),d.top+r<w.scrollTop()&&(r-=d.top+r-w.scrollTop()),h+2*PhotoWall.options.zoomImageBorder>w.width()&&(p*=(w.width()-2*PhotoWall.options.zoomImageBorder)/(h+2*PhotoWall.options.zoomImageBorder)),n*p+2*PhotoWall.options.zoomImageBorder>w.height()&&(p*=(w.height()-2*PhotoWall.options.zoomImageBorder)/(n*p+2*PhotoWall.options.zoomImageBorder)),o.animate({"margin-left":s,"margin-top":r,width:Math.round(h*p),height:Math.round(n*p),padding:PhotoWall.options.zoomImageBorder},{queue:!1,duration:PhotoWall.options.zoomDuration,easing:"linear"})}},PhotoWall.options.zoomTimeout))}),$(".pw-zoom").on("mouseleave",function(){var o=$(this),t=o.parent().parent();PhotoWall._photos[t.attr("id")];PhotoWall._zoom_timeout&&(clearTimeout(PhotoWall._zoom_timeout),PhotoWall._zoom_timeout=null),o.removeClass("pw-photo-hover"),o.hasClass("pw-photo-zoomed")&&(o.stop().css({margin:"",padding:"",width:PhotoWall._zs[0]+"px",height:PhotoWall._zs[1]+"px"}),PhotoWall._zs=null,o.removeClass("pw-photo-zoomed"))})}},ShowBox={version:"0.1.5",_opened:!1,_preview_locked:!1,_images:[],_index:0,_current:"",_inited:!1,_th:null,options:[],init:function(o,t){ShowBox.options.push($.extend({closeCallback:function(){},menuBarContent:"",onUpdate:null},t)),ShowBox._init(o),ShowBox._initEvents(o),ShowBox._parseGet()},_init:function(o){ShowBox._images.push([]),ShowBox.options[ShowBox.options.length-1].menuBarContent&&$("body").append('<div id="showbox-menubar'+(ShowBox.options.length-1)+'" style="overflow:hidden;width:100%;position:absolute;top:-999999px;">'+ShowBox.options[ShowBox.options.length-1].menuBarContent+"</div>"),ShowBox._inited||$('<div id="showbox" style="display:none;">\t<div id="showbox-exit"></div>\t<div class="showbox-menubar unselect" unselectable="on" style="display:none !important;"></div>\t<div class="showbox-image unselect" unselectable="on">\t</div>\t<div id="showbox-loader"></div>\t<div class="showbox-preview unselect">\t\t<div class="showbox-pv-lock"></div>\t\t<div class="showbox-th-counter" unselectable="on"></div>\t</div></div>').appendTo("body"),$("body").append('<div id="showbox-thc'+(ShowBox.options.length-1)+'" style="overflow:hidden;width:100%;position:absolute;top:-999999px;"><div class="showbox-th-container clearfix"></div></div>');var t=0,e=ShowBox._images.length-1;$(o).each(function(){var o=$(this);ShowBox._images[e].push([o.attr("href"),o.find("img").attr("src")]),ShowBox._addThumb(e,ShowBox._images[e][t][1],t),t++})},_initEvents:function(o){if(o){var t=ShowBox._images.length-1;$(o).on("click",function(o){o.preventDefault(),ShowBox._opened=!0;var e=t;ShowBox._current=e;var i=$(this);for(var h in ShowBox._images[e])if(ShowBox._images[e][h][0]==i.attr("href")){ShowBox._index=parseInt(h),ShowBox._th=$("#showbox-thc"+e+" .showbox-th").eq(h).addClass("showbox-th-active");break}ShowBox._show(e)})}ShowBox._inited||(ShowBox._inited=!0,$(document).keyup(function(o){ShowBox._opened&&ShowBox.KEYPRESSED(o)}),$("#showbox-exit").click(function(){ShowBox._opened&&ShowBox.EXIT(this)}),$("#showbox .showbox-preview").mouseenter(function(){ShowBox._preview_locked||ShowBox.OPENPREVIEW(this)}),$("#showbox .showbox-preview").mouseleave(function(){ShowBox._opened&&(ShowBox._preview_locked||ShowBox.CLOSEPREVIEW(this))}),$("#showbox .showbox-preview").click(function(){ShowBox._opened&&ShowBox.LOCKPREVIEW(this)}),$(window).resize(function(){ShowBox.RESIZE(this)}))},_parseGet:function(){var o=$_GET();if(o.p&&o.gal){ShowBox._opened=!0;var t=parseInt(o.gal)-1,e=parseInt(o.p)-1;if(ShowBox.options.length-1!=t)return;ShowBox._index=e,ShowBox._current=t,ShowBox._th=$("#showbox-thc"+t+" .showbox-th").eq(e).addClass("showbox-th-active"),ShowBox._show(t)}},_next:function(){var o=ShowBox._images[ShowBox._current].length;ShowBox._index+=1,ShowBox._index>=o&&(ShowBox._index=0),ShowBox._changeImage(ShowBox._index)},_prev:function(){var o=ShowBox._images[ShowBox._current].length;ShowBox._index-=1,ShowBox._index<0&&(ShowBox._index=o-1),ShowBox._changeImage(ShowBox._index)},_show:function(o){var t=$("#showbox-thc"+o).detach(),e=$("#showbox-menubar"+o).detach();t.appendTo("#showbox .showbox-preview"),e.prependTo("#showbox .showbox-menubar"),t.css({position:"relative",top:"0px"}),e.css({position:"relative",top:"0px"}),$("#showbox-loader").show(),$("body").css("overflow","hidden"),$("#showbox").fadeIn(200,function(){ShowBox._changeImage(ShowBox._index)}),$(".navbar-fixed-top").autoHidingNavbar("hide")},_addThumb:function(o,t,e){$('<div class="showbox-th"><img src="'+t+'" /></div>').appendTo("#showbox-thc"+o+" .showbox-th-container").find("img").load(function(){var o,t=$(this).width(),e=$(this).height(),i=1;i=t>=e?60/e:60/t,t=Math.round(t*i),e=Math.round(e*i),o=Math.round((t-60)/2),$(this).attr({width:t,height:e}).css({left:-o,top:-0})}).parent().click(function(o){o.stopPropagation();var t=e;ShowBox._changeImage(t)})},_onChangePhoto:function(){"function"==typeof ShowBox.options[ShowBox._current].onUpdate&&ShowBox.options[ShowBox._current].onUpdate()},_changeImage:function(o){$("#showbox-loader").show(),$("#showbox .showbox-menubar").hide(),$("#showbox .showbox-menubar").html(""),o=parseInt(o);var t=ShowBox._images[ShowBox._current].length;ShowBox._setCounter(o+1,t),window.location.hash="p="+(o+1)+"&gal="+(ShowBox._current+1),$("#showbox .showbox-menubar").append('<div id="showbox-menubar'+ShowBox._current+'" style="position:relative;">'+ShowBox.options[ShowBox._current].menuBarContent+"</div>"),ShowBox._onChangePhoto(),ShowBox._index=o,$("#showbox .showbox-img").remove(),ShowBox._th.removeClass("showbox-th-active"),ShowBox._th=$("#showbox .showbox-th").eq(o).addClass("showbox-th-active"),$('<img class="showbox-img" style="display:none;"/>').prependTo("#showbox .showbox-image").click(ShowBox._next).attr("src",ShowBox._images[ShowBox._current][o][0]).load(function(){if($.browser.msie)try{$(this).width(),$(this).height()}catch(o){}var o=$(this).prop("width"),t=$(this).prop("height");$(this).attr({width:o,height:t}).fadeIn(400),$("#showbox-loader").hide(),$("#showbox .showbox-menubar").show(),ShowBox.RESIZE()})},_setCounter:function(o,t){$("#showbox .showbox-th-counter").html(o+" of "+t)},_clearHash:function(){window.location.hash="_"},opened:function(){return ShowBox._opened},EXIT:function(o){ShowBox._clearHash(),ShowBox._opened=!1,$("body").css("overflow","auto"),$("#showbox").hide(),ShowBox.options[ShowBox._current].closeCallback(),$("#showbox .showbox-menubar").hide(),$("#showbox .showbox-image img").remove(),$("#showbox-thc"+ShowBox._current).css({position:"absolute",top:"-10000px"}).detach().appendTo("body"),$("#showbox-menubar"+ShowBox._current).css({position:"absolute",top:"-10000px"}).detach().appendTo("body"),$(".navbar-fixed-top").autoHidingNavbar("show")},KEYPRESSED:function(o){27==o.keyCode&&ShowBox.EXIT(),39==o.keyCode&&ShowBox._next(),37==o.keyCode&&ShowBox._prev()},OPENPREVIEW:function(o){$(o).animate({bottom:0},{queue:!1,duration:150})},CLOSEPREVIEW:function(o){$(o).animate({bottom:-75},{queue:!1,duration:150})},LOCKPREVIEW:function(o){ShowBox._preview_locked=!ShowBox._preview_locked,ShowBox._preview_locked?($("#showbox .showbox-pv-lock").show(),$(o).css({background:"#111","border-top":"1px solid #383838"})):($("#showbox .showbox-pv-lock").hide(),$(o).css({background:"","border-top":""}))},RESIZE:function(o){if(ShowBox._opened){var t=$("#showbox"),e=$("#showbox .showbox-image img"),i=t.width(),h=t.height()-146;ShowBox.options[ShowBox._current].menuBarContent||(h=t.height()-111);var n=parseInt(e.attr("height")),a=parseInt(e.attr("width")),l=1;n>h&&(l=h/n),a>i&&(1!=l?(factor2=i/(a*l),factor2<1&&(l*=factor2)):l=i/a);var s=Math.round(l*a),r=Math.round(l*n);(r>n||s>a)&&(s=a,r=n);var d=Math.round((i-s)/2),w=Math.round((h-r)/2)+5;$("#showbox .showbox-image").css({width:s+"px",height:r+"px","margin-left":d+"px","margin-top":w+"px"}).find(" img").css({width:s+"px",height:r+"px"});var p=Math.round(i/2)-(64*ShowBox._index+30);$("#showbox .showbox-th-container").animate({left:p},{duration:300,queue:!1})}}};